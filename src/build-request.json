{
  "kind": "build_request",
  "title": "Make the app permanent by persisting website content and user profiles across redeploys/upgrades",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Persist editable `websiteContent` in the backend so updates made via `updateWebsiteContent` survive canister redeploys/upgrades (draft expiration) instead of resetting to the hardcoded defaults.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "I want this to be permenent"
        ]
      },
      "acceptanceCriteria": [
        "After calling `updateWebsiteContent`, the updated content is still returned by `getWebsiteContent` after a canister upgrade/redeploy.",
        "On a fresh install (no prior state), `getWebsiteContent` returns the existing default content currently defined in `backend/main.mo`."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Persist `userProfiles` in the backend so profiles saved via `saveCallerUserProfile` survive canister redeploys/upgrades and remain available through `getCallerUserProfile`/`getUserProfile` after an upgrade.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "I want this to be permenent"
        ]
      },
      "acceptanceCriteria": [
        "After calling `saveCallerUserProfile`, the saved profile is still returned by `getCallerUserProfile` after a canister upgrade/redeploy.",
        "Existing authorization checks for profile read/write continue to work (unauthorized callers still trap as before)."
      ]
    },
    {
      "id": "REQ-3",
      "text": "Add upgrade-safe state handling for existing deployed canisters by implementing conditional migration support (create `backend/migration.mo` if needed) so current `websiteContent` and `userProfiles` are preserved when upgrading older versions that did not store this state stably.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "I want this to be permenent"
        ]
      },
      "acceptanceCriteria": [
        "Upgrading from the current version to the new version does not wipe existing `websiteContent` or `userProfiles`.",
        "If no legacy migration is needed for this project state, the implementation avoids unnecessary migration complexity and still preserves state across subsequent upgrades."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single Motoko actor with all logic in `backend/main.mo` (add `backend/migration.mo` only if required for conditional migration).",
    "Do not modify any files under `frontend/src/components/ui` or the immutable hook/bootstrap paths listed in SYSTEM_CONTEXT."
  ],
  "nonGoals": [
    "Adding new authentication providers beyond Internet Identity.",
    "Introducing external databases or non-Motoko backend services.",
    "Redesigning the UI/UX beyond what is necessary to support permanent persistence."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}